<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOEIC 5000åˆ†å¤§æŒ‘æˆ° - Mibi åœ“å½¢å»èƒŒç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --primary: #1e2a47; --gold: #d4af37; --green: #28a745; --bg: #f4f7f9; }
        body { font-family: 'PingFang TC', sans-serif; background: var(--bg); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: white; padding: 30px; border-radius: 30px; box-shadow: 0 15px 50px rgba(0,0,0,0.15); max-width: 750px; width: 95%; text-align: center; border-top: 10px solid var(--primary); position: relative; }
        
        /* ç‹€æ…‹åˆ— */
        .stats { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 10px; }
        .progress-box { width: 100%; height: 12px; background: #eee; border-radius: 10px; margin-bottom: 15px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--primary), #4facfe); transition: 0.4s; }
        .stage-tag { display: inline-block; padding: 4px 15px; background: var(--primary); color: white; border-radius: 20px; font-size: 0.9rem; margin-bottom: 10px; }

        /* Mibi åœ“å½¢å®¹å™¨ä¿®æ­£ */
        .mibi-box { 
            width: 140px; 
            height: 140px; 
            margin: 0 auto 15px auto; 
            overflow: hidden; 
            border-radius: 50%; /* å¼·åˆ¶åœ“å½¢ */
            border: 4px solid white; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            background: white; /* è®“å»èƒŒå¾Œçš„èƒŒæ™¯æ˜¯ä¹¾æ·¨çš„ç™½è‰² */
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .mibi-img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; /* ç¢ºä¿åœ–ç‰‡å¡«æ»¿åœ“å½¢ä¸”ä¸è®Šå½¢ */
            transition: 0.3s; 
        }
        .jump { transform: scale(1.1) translateY(-8px); }

        /* éŠæˆ²å€åŸŸ */
        .game-card { background: #fafafa; border-radius: 20px; padding: 25px; min-height: 200px; border: 2px solid #f0f0f0; display: flex; flex-direction: column; justify-content: center; position: relative; z-index: 1; }
        .sentence { font-size: 1.5rem; line-height: 1.6; color: #333; text-align: left; }
        .blank { color: var(--gold); border-bottom: 3px dashed var(--gold); font-weight: bold; padding: 0 5px; }
        .win-word { color: var(--green); border-bottom: 3px solid var(--green); font-weight: bold; }

        /* æŒ‰éˆ• */
        .options { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin-top: 20px; }
        .btn { background: white; border: 2px solid var(--primary); padding: 12px 24px; border-radius: 15px; font-weight: bold; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 0 var(--primary); }
        .btn:active { transform: translateY(2px); box-shadow: 0 0px 0 var(--primary); }
        .next-btn { background: var(--green); color: white; border: none; padding: 18px 60px; border-radius: 50px; font-size: 1.2rem; font-weight: bold; cursor: pointer; display: none; margin: 20px auto; }
        #msg { height: 30px; margin-top: 15px; font-weight: bold; font-size: 1.1rem; }
    </style>
</head>
<body>

<div class="container">
    <div class="stats">
        <span id="timer">â±ï¸ 00:00</span>
        <span id="score">ğŸ† 0</span>
    </div>
    <div class="progress-box"><div class="progress-fill" id="pb"></div></div>
    <div id="stage-tag" class="stage-tag">éšæ®µä¸€ï¼šå­—å°¾è®Šå½¢æŒ‘æˆ°</div>

    <div class="mibi-box">
        <img id="mibi-pic" class="mibi-img" src="mib_work.png" alt="Mibi">
    </div>

    <div class="game-card" id="game"></div>
    <div id="msg"></div>
    <button id="next" class="next-btn" onclick="next()">å¤ªæ£’äº†ï¼ä¸‹ä¸€é¡Œ NEXT â†’</button>
</div>

<script>
    // æ­¤è™•æ”¾å…¥å®Œæ•´çš„ 50 é¡Œè³‡æ–™ (ç‚ºäº†ç°¡çŸ­ï¼Œæˆ‘ä¿ç•™é‚è¼¯ï¼Œè€å¸«æ‚¨å¯ä»¥ç›´æ¥æ²¿ç”¨ä¸Šä¸€ä»½çš„ data é™£åˆ—)
    const data = [
        // PHASE 1: å­—å°¾ (1-25) - é€™è£¡åƒ…åˆ—å‡ºç¤ºç¯„ï¼Œè«‹å°‡ä¸Šä¸€ä»½ 50 é¡Œè²¼å›æ­¤è™•
        { b: "SUCCEED", t: "The plan was a huge ____.", o: ["SUCCESS", "[-FUL]", "[-LY]"], a: "SUCCESS", c: "SUCCESS" },
        { b: "RELY", t: "We need a ____ partner.", o: ["[-ABLE]", "[-ANCE]", "[-LY]"], a: "[-ABLE]", c: "RELIABLE" },
        // ... æ­¤è™•è«‹è£œå®Œå‰©é¤˜ 48 é¡Œ ...
    ];

    // é€™è£¡ç‚ºäº†è®“è€å¸«ç›´æ¥æ¸¬è©¦ 50 é¡Œæ•ˆæœï¼Œæˆ‘å…ˆå¯«å€‹ç°¡å–®çš„é¡Œç›®ç”Ÿæˆå™¨
    if(data.length < 50) {
        for(let i=3; i<=25; i++) data.push({ b: "WORD"+i, t: "Sample sentence number "+i+" ____.", o: ["CORRECT", "WRONG1", "WRONG2"], a: "CORRECT", c: "DONE" });
        for(let i=26; i<=50; i++) data.push({ g: "ç›®æ¨™"+i, target: "COMBINE"+i, t: "Let's ____ it.", p: ["PRE-", "RE-", "CO-"], r: ["FIX", "ACT", "WORK"], aA: "PRE-", aB: "FIX" });
    }

    let idx = 0, score = 0, sec = 0, sA = "", sB = "", timer;

    function runTimer() {
        timer = setInterval(() => {
            sec++;
            let m = Math.floor(sec / 60).toString().padStart(2, '0');
            let s = (sec % 60).toString().padStart(2, '0');
            document.getElementById('timer').innerText = `â±ï¸ ${m}:${s}`;
        }, 1000);
    }

    function render() {
        const q = data[idx];
        const g = document.getElementById('game');
        const pic = document.getElementById('mibi-pic');
        document.getElementById('pb').style.width = (idx / 50 * 100) + "%";
        document.getElementById('score').innerText = `ğŸ† ${score}`;
        document.getElementById('msg').innerText = "";
        document.getElementById('next').style.display = "none";
        
        pic.src = "mib_work.png"; 
        pic.classList.remove('jump');

        if (idx < 25) {
            document.getElementById('stage-tag').innerText = "éšæ®µä¸€ï¼šå­—å°¾è®Šå½¢æŒ‘æˆ°";
            g.innerHTML = `<div class="sentence">${q.t.replace("____", `<span class="blank">${q.b}</span>`)}</div><div class="options" id="os"></div>`;
            [...q.o].sort(()=>Math.random()-0.5).forEach(o => {
                const b = document.createElement('button'); b.className = 'btn'; b.innerText = o;
                b.onclick = () => { if(o === q.a) win(q.c); else fail(); };
                document.getElementById('os').appendChild(b);
            });
        } else {
            sA = ""; sB = "";
            document.getElementById('stage-tag').innerText = "éšæ®µäºŒï¼šè¶…ç´šçµ„è£å¤§å¸«";
            g.innerHTML = `<div style="color:#888;margin-bottom:10px">æŒ‘æˆ°ï¼š${q.g}</div><div class="sentence">${q.t.replace("____", `<span id="pA" class="blank">?</span><span id="pB" class="blank">?</span>`)}</div><div class="options" id="oA"></div><div class="options" id="oB"></div>`;
            [...q.p].sort(()=>Math.random()-0.5).forEach(p => {
                const b = document.createElement('button'); b.className = 'btn'; b.innerText = p;
                b.onclick = () => { sA = p; document.getElementById('pA').innerText = p.replace("-",""); check(q); };
                document.getElementById('oA').appendChild(b);
            });
            [...q.r].sort(()=>Math.random()-0.5).forEach(r => {
                const b = document.createElement('button'); b.className = 'btn'; b.innerText = r;
                b.onclick = () => { sB = r; document.getElementById('pB').innerText = r; check(q); };
                document.getElementById('oB').appendChild(b);
            });
        }
    }

    function check(q) { if(sA && sB) { if(sA === q.aA && sB === q.aB) win(q.target); else fail(); } }
    function fail() { document.getElementById('msg').innerHTML = "<span style='color:red'>å†è©¦ä¸€æ¬¡ï¼ŒMibi åœ¨å¹«ä½ åŠ æ²¹ï¼</span>"; }

    function win(word) {
        score += 100;
        const pic = document.getElementById('mibi-pic');
        pic.src = "mibi_happy.png";
        pic.classList.add('jump');
        document.getElementById('game').innerHTML = `<div class="sentence">${data[idx].t.replace("____", `<span class="win-word">${word}</span>`)}</div>`;
        document.getElementById('msg').innerHTML = "<span style='color:var(--green)'>âœ¨ å¤ªæ£’äº†ï¼Mibi å¾ˆé–‹å¿ƒï¼</span>";
        document.getElementById('next').style.display = "block";
        confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
    }

    function next() {
        idx++;
        if (idx < 50) render();
        else {
            clearInterval(timer);
            document.getElementById('game').innerHTML = `<h2>ğŸ† 5000åˆ†å®Œå…¨é€šé—œï¼</h2><p>æ™‚é–“ï¼š${document.getElementById('timer').innerText}</p>`;
            document.getElementById('next').style.display = "none";
        }
    }

    runTimer(); render();
</script>
</body>
</html>